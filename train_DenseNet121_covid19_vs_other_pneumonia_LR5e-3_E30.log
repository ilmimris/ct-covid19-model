python train_DenseNet121_covid19_LR5e-3_E30.py --dataset dataset_pneumonia
2020-04-05 21:59:13.249437: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll
[INFO] loading images...
2020-04-05 21:59:24.382107: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-04-05 21:59:25.133581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce 930MX computeCapability: 5.0
coreClock: 1.0195GHz coreCount: 3 deviceMemorySize: 2.00GiB deviceMemoryBandwidth: 14.92GiB/s
2020-04-05 21:59:25.149275: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll
2020-04-05 21:59:25.188560: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll
2020-04-05 21:59:25.275894: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll
2020-04-05 21:59:25.285230: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll
2020-04-05 21:59:25.347763: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll
2020-04-05 21:59:25.406025: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll
2020-04-05 21:59:25.435748: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-04-05 21:59:25.653172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-04-05 21:59:25.659880: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2020-04-05 21:59:25.670732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce 930MX computeCapability: 5.0
coreClock: 1.0195GHz coreCount: 3 deviceMemorySize: 2.00GiB deviceMemoryBandwidth: 14.92GiB/s
2020-04-05 21:59:25.938810: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll
2020-04-05 21:59:26.017433: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll
2020-04-05 21:59:26.032373: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll
2020-04-05 21:59:26.105871: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll
2020-04-05 21:59:26.119289: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll
2020-04-05 21:59:26.201552: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll
2020-04-05 21:59:26.342216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-04-05 21:59:26.571301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0
2020-04-05 21:59:28.249247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-05 21:59:28.256824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 
2020-04-05 21:59:28.261636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N
2020-04-05 21:59:28.266499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1377 MB memory) -> physical GPU (device: 0, name: GeForce 930MX, pci bus id: 0000:01:00.0, compute capability: 5.0)
[INFO] compiling model...
[INFO] training head...
WARNING:tensorflow:From train_DenseNet121_covid19_LR5e-3_E30.py:120: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to
  ['...']
Train for 19 steps, validate on 39 samples
Epoch 1/30
2020-04-05 21:59:41.208259: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll
2020-04-05 21:59:41.678654: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-04-05 21:59:43.389096: W tensorflow/stream_executor/gpu/redzone_allocator.cc:312] Internal: Invoking GPU asm compilation is supported on Cuda non-Windows platforms only
Relying on driver to perform ptx compilation. This message will be only logged once.
19/19 [==============================] - 27s 1s/step - loss: 1.6013 - accuracy: 0.6463 - val_loss: 0.6469 - val_accuracy: 0.6562
Epoch 2/30
19/19 [==============================] - 7s 383ms/step - loss: 0.7105 - accuracy: 0.7687 - val_loss: 0.3592 - val_accuracy: 0.7500
Epoch 3/30
19/19 [==============================] - 7s 382ms/step - loss: 0.2579 - accuracy: 0.8707 - val_loss: 0.5120 - val_accuracy: 0.5625
Epoch 4/30
19/19 [==============================] - 7s 386ms/step - loss: 0.3551 - accuracy: 0.8163 - val_loss: 0.3743 - val_accuracy: 0.7812
Epoch 5/30
19/19 [==============================] - 7s 385ms/step - loss: 0.2934 - accuracy: 0.9184 - val_loss: 0.4347 - val_accuracy: 0.8125
Epoch 6/30
19/19 [==============================] - 7s 388ms/step - loss: 0.2106 - accuracy: 0.9252 - val_loss: 0.3744 - val_accuracy: 0.7812
Epoch 7/30
19/19 [==============================] - 7s 392ms/step - loss: 0.1626 - accuracy: 0.9320 - val_loss: 0.3370 - val_accuracy: 0.8125
Epoch 8/30
19/19 [==============================] - 7s 384ms/step - loss: 0.1846 - accuracy: 0.9116 - val_loss: 0.4461 - val_accuracy: 0.7500
Epoch 9/30
19/19 [==============================] - 7s 393ms/step - loss: 0.1319 - accuracy: 0.9524 - val_loss: 0.4263 - val_accuracy: 0.7500
Epoch 10/30
19/19 [==============================] - 7s 382ms/step - loss: 0.1791 - accuracy: 0.9252 - val_loss: 0.3810 - val_accuracy: 0.7812
Epoch 11/30
19/19 [==============================] - 7s 385ms/step - loss: 0.1514 - accuracy: 0.9320 - val_loss: 0.3519 - val_accuracy: 0.9062
Epoch 12/30
19/19 [==============================] - 7s 381ms/step - loss: 0.1025 - accuracy: 0.9456 - val_loss: 0.6028 - val_accuracy: 0.7500
Epoch 13/30
19/19 [==============================] - 7s 395ms/step - loss: 0.0676 - accuracy: 0.9671 - val_loss: 0.3872 - val_accuracy: 0.8750
Epoch 14/30
19/19 [==============================] - 7s 393ms/step - loss: 0.1049 - accuracy: 0.9737 - val_loss: 0.6147 - val_accuracy: 0.7500
Epoch 15/30
19/19 [==============================] - 7s 394ms/step - loss: 0.1160 - accuracy: 0.9524 - val_loss: 0.3346 - val_accuracy: 0.9375
Epoch 16/30
19/19 [==============================] - 7s 385ms/step - loss: 0.1367 - accuracy: 0.9592 - val_loss: 0.3367 - val_accuracy: 0.8750
Epoch 17/30
19/19 [==============================] - 8s 396ms/step - loss: 0.0782 - accuracy: 0.9728 - val_loss: 0.3668 - val_accuracy: 0.8125
Epoch 18/30
19/19 [==============================] - 7s 392ms/step - loss: 0.0925 - accuracy: 0.9796 - val_loss: 0.7585 - val_accuracy: 0.7500
Epoch 19/30
19/19 [==============================] - 7s 389ms/step - loss: 0.0587 - accuracy: 0.9728 - val_loss: 0.3946 - val_accuracy: 0.7500
Epoch 20/30
19/19 [==============================] - 8s 395ms/step - loss: 0.0961 - accuracy: 0.9592 - val_loss: 0.4259 - val_accuracy: 0.9062
Epoch 21/30
19/19 [==============================] - 7s 390ms/step - loss: 0.1903 - accuracy: 0.9388 - val_loss: 0.8525 - val_accuracy: 0.5938
Epoch 22/30
19/19 [==============================] - 7s 389ms/step - loss: 0.1873 - accuracy: 0.9456 - val_loss: 0.7939 - val_accuracy: 0.6562
Epoch 23/30
19/19 [==============================] - 7s 387ms/step - loss: 0.0746 - accuracy: 0.9728 - val_loss: 0.3419 - val_accuracy: 0.8438
Epoch 24/30
19/19 [==============================] - 7s 391ms/step - loss: 0.0698 - accuracy: 0.9728 - val_loss: 0.6700 - val_accuracy: 0.7812
Epoch 25/30
19/19 [==============================] - 7s 389ms/step - loss: 0.0882 - accuracy: 0.9592 - val_loss: 0.3979 - val_accuracy: 0.8750
Epoch 26/30
19/19 [==============================] - 8s 415ms/step - loss: 0.0667 - accuracy: 0.9728 - val_loss: 0.4216 - val_accuracy: 0.8438
Epoch 27/30
19/19 [==============================] - 8s 401ms/step - loss: 0.0971 - accuracy: 0.9524 - val_loss: 0.3618 - val_accuracy: 0.8125
Epoch 28/30
19/19 [==============================] - 7s 389ms/step - loss: 0.0953 - accuracy: 0.9456 - val_loss: 0.4317 - val_accuracy: 0.8125
Epoch 29/30
19/19 [==============================] - 8s 442ms/step - loss: 0.0420 - accuracy: 1.0000 - val_loss: 0.4141 - val_accuracy: 0.9062
Epoch 30/30
19/19 [==============================] - 8s 409ms/step - loss: 0.0875 - accuracy: 0.9524 - val_loss: 0.4327 - val_accuracy: 0.9062
[INFO] evaluating network...
              precision    recall  f1-score   support

       covid       1.00      0.79      0.88        19
    notcovid       0.83      1.00      0.91        20

    accuracy                           0.90        39
   macro avg       0.92      0.89      0.90        39
weighted avg       0.91      0.90      0.90        39

[[15  4]
 [ 0 20]]
acc: 0.8974
sensitivity: 0.7895
specificity: 1.0000
[INFO] saving COVID-19 detector model...